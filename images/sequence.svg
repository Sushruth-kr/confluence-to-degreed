<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="814px" preserveAspectRatio="none" style="width:3828px;height:814px;" version="1.1" viewBox="0 0 3828 814" width="3828px" zoomAndPan="magnify"><defs><filter height="300%" id="fi7x4haaz43em" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#fi7x4haaz43em)" height="133.6641" style="stroke: #000000; stroke-width: 2.0;" width="1440.5" x="601" y="142.6953"/><rect fill="#FFFFFF" filter="url(#fi7x4haaz43em)" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="3216.5" x="601" y="682.0859"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="81" x2="81" y1="38.2969" y2="774.4844"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="737" x2="737" y1="38.2969" y2="774.4844"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1242" x2="1242" y1="38.2969" y2="774.4844"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1411" x2="1411" y1="38.2969" y2="774.4844"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1771.5" x2="1771.5" y1="38.2969" y2="774.4844"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1886.5" x2="1886.5" y1="38.2969" y2="774.4844"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1985.5" x2="1985.5" y1="38.2969" y2="774.4844"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2257.5" x2="2257.5" y1="38.2969" y2="774.4844"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2576.5" x2="2576.5" y1="38.2969" y2="774.4844"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2812" x2="2812" y1="38.2969" y2="774.4844"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3130.5" x2="3130.5" y1="38.2969" y2="774.4844"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3766.5" x2="3766.5" y1="38.2969" y2="774.4844"/><rect fill="#FEFECE" filter="url(#fi7x4haaz43em)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="142" x="8" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="15" y="22.9951">CloudWatch Event</text><rect fill="#FEFECE" filter="url(#fi7x4haaz43em)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="142" x="8" y="773.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="15" y="793.4795">CloudWatch Event</text><rect fill="#FEFECE" filter="url(#fi7x4haaz43em)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="248" x="611" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="234" x="618" y="22.9951">Confluence-to-Wiki Step Function</text><rect fill="#FEFECE" filter="url(#fi7x4haaz43em)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="248" x="611" y="773.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="234" x="618" y="793.4795">Confluence-to-Wiki Step Function</text><rect fill="#FEFECE" filter="url(#fi7x4haaz43em)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="144" x="1168" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="130" x="1175" y="22.9951">listSpaces Lambda</text><rect fill="#FEFECE" filter="url(#fi7x4haaz43em)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="144" x="1168" y="773.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="130" x="1175" y="793.4795">listSpaces Lambda</text><rect fill="#FEFECE" filter="url(#fi7x4haaz43em)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="166" x="1326" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="152" x="1333" y="22.9951">spaceHandler Lambda</text><rect fill="#FEFECE" filter="url(#fi7x4haaz43em)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="166" x="1326" y="773.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="152" x="1333" y="793.4795">spaceHandler Lambda</text><rect fill="#FEFECE" filter="url(#fi7x4haaz43em)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="117" x="1711.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="103" x="1718.5" y="22.9951">Confluence API</text><rect fill="#FEFECE" filter="url(#fi7x4haaz43em)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="117" x="1711.5" y="773.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="103" x="1718.5" y="793.4795">Confluence API</text><rect fill="#FEFECE" filter="url(#fi7x4haaz43em)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="84" x="1842.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="1849.5" y="22.9951">S3 Bucket</text><rect fill="#FEFECE" filter="url(#fi7x4haaz43em)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="84" x="1842.5" y="773.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="1849.5" y="793.4795">S3 Bucket</text><rect fill="#FEFECE" filter="url(#fi7x4haaz43em)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="87" x="1940.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="1947.5" y="22.9951">Athena DB</text><rect fill="#FEFECE" filter="url(#fi7x4haaz43em)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="87" x="1940.5" y="773.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="1947.5" y="793.4795">Athena DB</text><rect fill="#FEFECE" filter="url(#fi7x4haaz43em)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="183" x="2164.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="169" x="2171.5" y="22.9951">degreedHandler Lambda</text><rect fill="#FEFECE" filter="url(#fi7x4haaz43em)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="183" x="2164.5" y="773.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="169" x="2171.5" y="793.4795">degreedHandler Lambda</text><rect fill="#FEFECE" filter="url(#fi7x4haaz43em)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="2525.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="2532.5" y="22.9951">Degreed API</text><rect fill="#FEFECE" filter="url(#fi7x4haaz43em)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="2525.5" y="773.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="2532.5" y="793.4795">Degreed API</text><rect fill="#FEFECE" filter="url(#fi7x4haaz43em)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="216" x="2702" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="202" x="2709" y="22.9951">generateContentFile Lambda</text><rect fill="#FEFECE" filter="url(#fi7x4haaz43em)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="216" x="2702" y="773.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="202" x="2709" y="793.4795">generateContentFile Lambda</text><rect fill="#FEFECE" filter="url(#fi7x4haaz43em)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="151" x="3053.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="137" x="3060.5" y="22.9951">emailNotify Lambda</text><rect fill="#FEFECE" filter="url(#fi7x4haaz43em)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="151" x="3053.5" y="773.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="137" x="3060.5" y="793.4795">emailNotify Lambda</text><rect fill="#FEFECE" filter="url(#fi7x4haaz43em)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="77" x="3726.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="63" x="3733.5" y="22.9951">SendGrid</text><rect fill="#FEFECE" filter="url(#fi7x4haaz43em)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="77" x="3726.5" y="773.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="63" x="3733.5" y="793.4795">SendGrid</text><polygon fill="#A80036" points="725,65.4297,735,69.4297,725,73.4297,729,69.4297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="81" x2="731" y1="69.4297" y2="69.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="88" y="64.3638">[010]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="587" x="133" y="64.3638">Periodic (expecting daily, but periodicity is adjustable) event kicks off content load function</text><polygon fill="#A80036" points="1230,94.5625,1240,98.5625,1230,102.5625,1234,98.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="737" x2="1236" y1="98.5625" y2="98.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="744" y="93.4966">[020]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="789" y="93.4966">execute "Spaces" Workflow</text><polygon fill="#A80036" points="748,123.6953,738,127.6953,748,131.6953,744,127.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="742" x2="1241" y1="127.6953" y2="127.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="40" x="754" y="122.6294">[030]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="437" x="798" y="122.6294">"Return list of spaces from either config param or dynamoDB table"</text><path d="M601,142.6953 L679,142.6953 L679,149.6953 L669,159.6953 L601,159.6953 L601,142.6953 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="133.6641" style="stroke: #000000; stroke-width: 2.0;" width="1440.5" x="601" y="142.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="33" x="616" y="155.7622">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="152" x="694" y="154.9058">["for every space key"]</text><polygon fill="#A80036" points="1399,176.9609,1409,180.9609,1399,184.9609,1403,180.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="737" x2="1405" y1="180.9609" y2="180.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="744" y="175.895">[040]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="206" x="789" y="175.895">run spaceHandler for space key</text><polygon fill="#A80036" points="1760,206.0938,1770,210.0938,1760,214.0938,1764,210.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1411" x2="1766" y1="210.0938" y2="210.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="1418" y="205.0278">[050]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="292" x="1463" y="205.0278">pull all pages (link and metadata) from space</text><polygon fill="#A80036" points="1874.5,235.2266,1884.5,239.2266,1874.5,243.2266,1878.5,239.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1411" x2="1880.5" y1="239.2266" y2="239.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="1418" y="234.1606">[060]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="356" x="1463" y="234.1606">upload space results as CSV (spaces/&lt;spacekey&gt;.csv)</text><polygon fill="#A80036" points="1974,264.3594,1984,268.3594,1974,272.3594,1978,268.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1411" x2="1980" y1="268.3594" y2="268.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="1418" y="263.2935">[070]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="1463" y="263.2935">create "wiki_spaces" table</text><polygon fill="#A80036" points="2246,300.4922,2256,304.4922,2246,308.4922,2250,304.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="737" x2="2252" y1="304.4922" y2="304.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="744" y="299.4263">[080]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="789" y="299.4263">Execute Degreed Workflow</text><polygon fill="#A80036" points="2565,329.625,2575,333.625,2565,337.625,2569,333.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2258" x2="2571" y1="333.625" y2="333.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="2265" y="328.5591">[090]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="250" x="2310" y="328.5591">Read all wiki pages in degreed catalog</text><polygon fill="#A80036" points="1897.5,358.7578,1887.5,362.7578,1897.5,366.7578,1893.5,362.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1891.5" x2="2257" y1="362.7578" y2="362.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="1903.5" y="357.6919">[100]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="287" x="1948.5" y="357.6919">upload results as CSV (degreed/articles.csv)</text><polygon fill="#A80036" points="1997,387.8906,1987,391.8906,1997,395.8906,1993,391.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1991" x2="2257" y1="391.8906" y2="391.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="40" x="2003" y="386.8247">[110]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="204" x="2047" y="386.8247">create "degreed_articles" table</text><polygon fill="#A80036" points="2800,417.0234,2810,421.0234,2800,425.0234,2804,421.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="737" x2="2806" y1="421.0234" y2="421.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="40" x="744" y="415.9575">[120]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="217" x="788" y="415.9575">execute content upload workflow</text><polygon fill="#A80036" points="1997,446.1563,1987,450.1563,1997,454.1563,1993,450.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1991" x2="2811" y1="450.1563" y2="450.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="39" x="2003" y="445.0903">[130]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="204" x="2046" y="445.0903">select degreed_articles that do</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="2254" y="445.0903">not</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="458" x="2285" y="445.0903">have a match in wiki_spaces, to create a list of "to be deleted" articles</text><polygon fill="#A80036" points="1997,475.2891,1987,479.2891,1997,483.2891,1993,479.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1991" x2="2811" y1="479.2891" y2="479.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="40" x="2003" y="474.2231">[140]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="623" x="2047" y="474.2231">select degreed_articles that do have a match in wiki_spaces, to create a list of "update" articles</text><polygon fill="#A80036" points="1997,504.4219,1987,508.4219,1997,512.4219,1993,508.4219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1991" x2="2811" y1="508.4219" y2="508.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="40" x="2003" y="503.356">[150]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="584" x="2047" y="503.356">select wiki_spaces pages that do not show up in degreed, to create a list of "new" articles</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="2812" x2="2854" y1="537.5547" y2="537.5547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2854" x2="2854" y1="537.5547" y2="550.5547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2813" x2="2854" y1="550.5547" y2="550.5547"/><polygon fill="#A80036" points="2823,546.5547,2813,550.5547,2823,554.5547,2819,550.5547" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="40" x="2819" y="532.4888">[160]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="261" x="2863" y="532.4888">merge lists to create content upload file</text><polygon fill="#A80036" points="2588,575.6875,2578,579.6875,2588,583.6875,2584,579.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2582" x2="2811" y1="579.6875" y2="579.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="40" x="2594" y="574.6216">[170]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="2638" y="574.6216">upload content upload file</text><polygon fill="#A80036" points="1997,604.8203,1987,608.8203,1997,612.8203,1993,608.8203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1991" x2="2811" y1="608.8203" y2="608.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="40" x="2003" y="603.7544">[180]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="488" x="2047" y="603.7544">find list of wiki pages marked for deletion that are in one or more pathways</text><polygon fill="#A80036" points="748,633.9531,738,637.9531,748,641.9531,744,637.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="742" x2="2811" y1="637.9531" y2="637.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="40" x="754" y="632.8872">[190]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="690" x="798" y="632.8872">pass list of pathways, creators for the pathways and the urls that are marked for deletion to the next step</text><polygon fill="#A80036" points="3119,663.0859,3129,667.0859,3119,671.0859,3123,667.0859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="737" x2="3125" y1="667.0859" y2="667.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="744" y="662.02">[200]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="292" x="789" y="662.02">take deleted url/pathway/creator list as input</text><path d="M601,682.0859 L679,682.0859 L679,689.0859 L669,699.0859 L601,699.0859 L601,682.0859 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="3216.5" x="601" y="682.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="33" x="616" y="695.1528">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="273" x="694" y="694.2964">["for each URL/Pathway/Creator Tuplet"]</text><polygon fill="#A80036" points="3755,716.3516,3765,720.3516,3755,724.3516,3759,720.3516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3131" x2="3761" y1="720.3516" y2="720.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="40" x="3138" y="715.2856">[210]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="568" x="3182" y="715.2856">Send email to creator letting them know that content in their pathway is "disappearing"</text><polygon fill="#A80036" points="748,745.4844,738,749.4844,748,753.4844,744,749.4844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="742" x2="3130" y1="749.4844" y2="749.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="40" x="754" y="744.4185">[220]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="798" y="744.4185">Success!</text><!--MD5=[f4f4688ecc5c08a17a420fbd09701a43]
@startuml
autonumber 10 10 "<b>[000]"

"CloudWatch Event" as cwe -> "Confluence-to-Wiki Step Function" as step: Periodic (expecting daily, but periodicity is adjustable) event kicks off content load function
step -> "listSpaces Lambda" as ls_lwf: execute "Spaces" Workflow
ls_lwf -> step: "Return list of spaces from either config param or dynamoDB table"
loop "for every space key"
  step -> "spaceHandler Lambda" as sh_lwf: run spaceHandler for space key
  sh_lwf -> "Confluence API" as confapi: pull all pages (link and metadata) from space
  sh_lwf -> "S3 Bucket" as s3bucket: upload space results as CSV (spaces/<spacekey>.csv)
  sh_lwf -> "Athena DB" as athena: create "wiki_spaces" table
end

step -> "degreedHandler Lambda" as degreed_lwf: Execute Degreed Workflow
degreed_lwf -> "Degreed API" as degreedapi: Read all wiki pages in degreed catalog
degreed_lwf -> s3bucket: upload results as CSV (degreed/articles.csv)
degreed_lwf -> athena: create "degreed_articles" table

step -> "generateContentFile Lambda" as content_lwf: execute content upload workflow
content_lwf->athena: select degreed_articles that do **not** have a match in wiki_spaces, to create a list of "to be deleted" articles
content_lwf->athena: select degreed_articles that do have a match in wiki_spaces, to create a list of "update" articles
content_lwf->athena: select wiki_spaces pages that do not show up in degreed, to create a list of "new" articles
content_lwf->content_lwf: merge lists to create content upload file
content_lwf->degreedapi: upload content upload file
content_lwf->athena: find list of wiki pages marked for deletion that are in one or more pathways
content_lwf->step: pass list of pathways, creators for the pathways and the urls that are marked for deletion to the next step

step -> "emailNotify Lambda" as email_notify: take deleted url/pathway/creator list as input
loop "for each URL/Pathway/Creator Tuplet"
  email_notify-> "SendGrid" as sendgrid: Send email to creator letting them know that content in their pathway is "disappearing"
  email_notify ->step: Success!
end
@enduml

PlantUML version 1.2020.00(Sat Jan 11 12:30:53 UTC 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.7.0_231-mockbuild_2019_08_02_17_36-b00
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>